{"version":3,"sources":["app/state.ts","ui/Pool.tsx","app/simulation.ts","ui/Output/Breakdown.tsx","ui/Output.tsx","ui/Modifiers.tsx","ui/IterationSlider.tsx","ui/SeedInput.tsx","app/App.tsx","index.tsx"],"names":["Prando","nextString","encodeConfig","config","btoa","JSON","stringify","DiceInput","props","Item","label","value","count","min","onChange","Number","isInteger","AttackDieSide","DefenseDieSide","Pool","dice","this","labelCol","xs","span","sm","red","v","updateDice","black","white","newPool","onChanged","React","Component","AttackDieType","crit","surge","hit","blank","DefenseDieType","block","AttackDie","sides","rng","nextArrayItem","DefenseDie","AttackBranch","rolled","modifiers","hits","crits","cover","defender","aggregateDice","Math","max","armor","convert","impact","DefenseBranch","stats","Array","fill","blocks","generateDefenseDice","roll","surges","Simulation","rngSeed","results","dicePool","attackPool","i","push","branches","iterations","length","generateAttackDice","map","d","attackModifiers","defending","name","none","woundsByCoverAmount","data","branch","wounds","expectedWounds","w","toFixed","key","cover0","cover1","cover2","bordered","columns","title","dataIndex","dataSource","pagination","size","simulate","grouped","ticks","Set","rawTotalHits","add","animate","duration","domainPadding","x","height","Object","entries","y","labels","datum","style","axisLabel","padding","mods","Option","Select","slideToIterations","slider","App","defaultState","marks","1","3","5","toString","tipFormatter","maxLength","target","offset","icon","SyncOutlined","onClick","Sider","Layout","state","parse","fragment","urlState","window","location","hash","indexOf","substring","atob","decodeConfig","encodedState","defaultEncodedState","encodeStateIfChanged","minHeight","breakpoint","collapsedWidth","width","className","shortHash","SettingOutlined","layout","IterationSlider","setState","SeedInput","disabled","type","StarOutlined","newDice","EditOutlined","Modifiers","newModifiers","Content","margin","Output","freeze","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.56648de3.chunk.js","sourcesContent":["import Prando from 'prando';\n\nexport let sessionRngSeed = new Prando().nextString(10);\n\n/**\n * Simulation-wide state (or configuration).\n */\nexport interface SimConfig {\n  /**\n   * Attacking dice pool.\n   */\n  attackPool: AttackDiceConfig;\n\n  /**\n   * Attacking dice pool modifiers.\n   */\n  attackModifiers: AttackDiceModifiers;\n\n  /**\n   * Number of times the dice should be rolled.\n   */\n  iterations: number;\n\n  /**\n   * Random seed used for simulations.\n   */\n  rngSeed: string;\n}\n\n/**\n * Encodes the provided configuration as base-64 encoded string.\n *\n * @param config\n */\nexport function encodeConfig(config: SimConfig): string {\n  return btoa(JSON.stringify(config));\n}\n\n/**\n * Decodes the provided hash-fragment URL into a config.\n *\n * Returns {undefined} if there was no stored configuration.\n */\nexport function decodeConfig(fragment: string): SimConfig | undefined {\n  let urlState = window.location.hash;\n  if (urlState) {\n    const fragment = urlState.indexOf('#');\n    if (fragment !== -1) {\n      urlState = urlState.substring(fragment + 1);\n    }\n    if (urlState && urlState.length) {\n      return JSON.parse(atob(urlState));\n    }\n  }\n  return undefined;\n}\n\nexport interface AttackDiceConfig {\n  /**\n   * Number of red dice.\n   */\n  red: number;\n\n  /**\n   * Number of black dice.\n   */\n  black: number;\n\n  /**\n   * Number of white dice.\n   */\n  white: number;\n}\n\nexport interface AttackDiceModifiers {\n  /**\n   * What the `surge` icon the dice should convert to.\n   */\n  surge: 'none' | 'hit' | 'crit';\n\n  /**\n   * How much impact the dice pool has.\n   */\n  impact: number;\n}\n","import React from 'react';\nimport { Form, InputNumber } from 'antd';\nimport { AttackDiceConfig } from '../app/state';\n\nfunction DiceInput(props: {\n  label: React.ReactNode;\n  count: number;\n  onChange: (count: number) => void;\n}) {\n  return (\n    <Form.Item label={props.label}>\n      <InputNumber\n        value={props.count}\n        min={0}\n        onChange={(value = 0) => {\n          props.onChange(Number.isInteger(value) ? value : props.count);\n        }}\n      ></InputNumber>\n    </Form.Item>\n  );\n}\n\nexport default class Pool extends React.Component<PoolProps> {\n  render() {\n    const dice = this.props.dice;\n    return (\n      <Form\n        labelCol={{\n          xs: { span: 24 },\n          sm: { span: 8 },\n        }}\n      >\n        <DiceInput\n          label=\"Red\"\n          count={dice.red}\n          onChange={(v: number) => this.updateDice({ red: v })}\n        />\n        <DiceInput\n          label=\"Black\"\n          count={dice.black}\n          onChange={(v: number) => this.updateDice({ black: v })}\n        />\n        <DiceInput\n          label=\"White\"\n          count={dice.white}\n          onChange={(v: number) => this.updateDice({ white: v })}\n        />\n      </Form>\n    );\n  }\n\n  updateDice(newPool: Partial<AttackDiceConfig>) {\n    this.props.onChanged({ ...this.props.dice, ...newPool });\n  }\n}\n\nexport interface PoolProps {\n  readonly dice: AttackDiceConfig;\n  readonly onChanged: (pool: AttackDiceConfig) => void;\n}\n","import Prando from 'prando';\nimport { SimConfig, AttackDiceModifiers } from './state';\n\n/**\n * Sides of an attack die.\n */\nexport enum AttackDieSide {\n  blank = 'blank',\n  surge = 'surge',\n  hit = 'hit',\n  crit = 'crit',\n}\n\n/**\n * Sides of a defense die.\n */\nexport enum DefenseDieSide {\n  blank = 'blank',\n  surge = 'surge',\n  block = 'block',\n}\n\n/**\n * Types of an attack die.\n */\nexport const AttackDieType = {\n  white: [\n    AttackDieSide.crit,\n    AttackDieSide.surge,\n    AttackDieSide.hit,\n    AttackDieSide.blank,\n    AttackDieSide.blank,\n    AttackDieSide.blank,\n    AttackDieSide.blank,\n    AttackDieSide.blank,\n  ],\n  black: [\n    AttackDieSide.crit,\n    AttackDieSide.surge,\n    AttackDieSide.hit,\n    AttackDieSide.hit,\n    AttackDieSide.hit,\n    AttackDieSide.blank,\n    AttackDieSide.blank,\n    AttackDieSide.blank,\n  ],\n  red: [\n    AttackDieSide.crit,\n    AttackDieSide.surge,\n    AttackDieSide.hit,\n    AttackDieSide.hit,\n    AttackDieSide.hit,\n    AttackDieSide.hit,\n    AttackDieSide.hit,\n    AttackDieSide.blank,\n  ],\n};\n\n/**\n * Types of a defense die.\n */\nexport const DefenseDieType = {\n  white: [\n    DefenseDieSide.block,\n    DefenseDieSide.surge,\n    DefenseDieSide.blank,\n    DefenseDieSide.blank,\n    DefenseDieSide.blank,\n    DefenseDieSide.blank,\n  ],\n\n  red: [\n    DefenseDieSide.block,\n    DefenseDieSide.block,\n    DefenseDieSide.block,\n    DefenseDieSide.surge,\n    DefenseDieSide.blank,\n    DefenseDieSide.blank,\n  ],\n};\n\n/**\n * Defines a single attack die.\n */\nexport class AttackDie {\n  static red(): AttackDie {\n    return new AttackDie(AttackDieType.red);\n  }\n\n  static black(): AttackDie {\n    return new AttackDie(AttackDieType.black);\n  }\n\n  static white(): AttackDie {\n    return new AttackDie(AttackDieType.white);\n  }\n\n  private constructor(private readonly sides: AttackDieSide[]) {}\n\n  /**\n   * With the provided {rng}, changes the result of the die.\n   */\n  roll(rng: Prando): AttackDieSide {\n    return rng.nextArrayItem(this.sides);\n  }\n}\n\n/**\n * Defines a single defense die.\n */\nexport class DefenseDie {\n  static red(): DefenseDie {\n    return new DefenseDie(DefenseDieType.red);\n  }\n\n  static white(): DefenseDie {\n    return new DefenseDie(DefenseDieType.white);\n  }\n\n  static none(): DefenseDie {\n    return new DefenseDie([DefenseDieSide.blank]);\n  }\n\n  private constructor(private readonly sides: DefenseDieSide[]) {}\n\n  /**\n   * With the provided {rng}, changes the result of the die.\n   */\n  roll(rng: Prando): DefenseDieSide {\n    return rng.nextArrayItem(this.sides);\n  }\n}\n\nexport interface DefenseStats {\n  /**\n   * Type of defense die\n   */\n  dice: DefenseDie;\n\n  /**\n   * Set if the die surge-side is considered a block.\n   */\n  surges?: true;\n\n  /**\n   * Set if numerical or unlimited armor.\n   */\n  armor?: number | true;\n\n  /**\n   * Set if immune to pierce.\n   */\n  immunePierce?: true;\n}\n\nexport class AttackBranch {\n  constructor(\n    private readonly rng: Prando,\n    private readonly rolled: AttackDieSide[],\n    private readonly modifiers: AttackDiceModifiers,\n  ) {}\n\n  private aggregateDice(): { hits: number; crits: number } {\n    let hits = 0;\n    let crits = 0;\n\n    for (const roll of this.rolled) {\n      switch (roll) {\n        case AttackDieSide.crit:\n          crits++;\n          break;\n        case AttackDieSide.hit:\n          hits++;\n          break;\n        case AttackDieSide.surge:\n          switch (this.modifiers.surge) {\n            case 'crit':\n              crits++;\n              break;\n            case 'hit':\n              hits++;\n              break;\n            default:\n              break;\n          }\n          break;\n        case AttackDieSide.blank:\n          break;\n      }\n    }\n\n    return { hits, crits };\n  }\n\n  /**\n   * Returns the computed number of hits given cover and defense stats.\n   */\n  hits(cover: number, defender: DefenseStats): DefenseBranch {\n    let { hits, crits } = this.aggregateDice();\n\n    // Reduce hits by the amount of static cover, to a minimum of 0.\n    hits = Math.max(0, hits - cover);\n\n    // If `armor`, convert hits to crits, and deplete all or some hits.\n    if (defender.armor) {\n      const convert = Math.min(hits, this.modifiers.impact);\n      hits -= convert;\n      crits += convert;\n\n      if (defender.armor === true) {\n        // All non-converted hits are now cancelled.\n        hits = 0;\n      } else {\n        // Reduce hits by the amount of static armor, to a minimum of 0.\n        hits = Math.max(0, hits - defender.armor);\n      }\n    }\n\n    // Final number of dice that will need to be rolled for wounds.\n    // TODO: Consider returning multiple branches per attack.\n    return new DefenseBranch(this.rng, hits + crits, defender);\n  }\n\n  get rawTotalHits(): number {\n    let { hits, crits } = this.aggregateDice();\n    return hits + crits;\n  }\n}\n\nexport class DefenseBranch {\n  constructor(\n    private readonly rng: Prando,\n    public readonly hits: number,\n    private readonly stats: DefenseStats,\n  ) {}\n\n  /**\n   * Given the configuration, generates appropriate defense dice.\n   */\n  private generateDefenseDice(): DefenseDie[] {\n    return Array(this.hits).fill(this.stats.dice);\n  }\n\n  /**\n   * Computes the number of wounds based on rolling defensive dice.\n   */\n  wounds(): number {\n    let blocks = 0;\n\n    for (const die of this.generateDefenseDice()) {\n      switch (die.roll(this.rng)) {\n        case DefenseDieSide.block:\n          blocks++;\n          break;\n        case DefenseDieSide.surge:\n          if (this.stats.surges) {\n            blocks++;\n          }\n          break;\n        case DefenseDieSide.blank:\n          break;\n      }\n    }\n\n    // TODO: Apply pierce.\n    // Future-proof against things like danger sense, a minimum of 0 wounds.\n    return Math.max(0, this.hits - blocks);\n  }\n}\n\n/**\n * Manages running the simulation from the top-down (as the root).\n */\nexport class Simulation {\n  private readonly rng: Prando;\n\n  constructor(private readonly config: SimConfig) {\n    this.rng = new Prando(config.rngSeed);\n  }\n\n  /**\n   * Given the configuration, generates appropriate attack dice.\n   */\n  private generateAttackDice(): AttackDie[] {\n    const results: AttackDie[] = [];\n    const dicePool = this.config.attackPool;\n    for (let i = 0; i < dicePool.red; i++) {\n      results.push(AttackDie.red());\n    }\n    for (let i = 0; i < dicePool.black; i++) {\n      results.push(AttackDie.black());\n    }\n    for (let i = 0; i < dicePool.white; i++) {\n      results.push(AttackDie.white());\n    }\n    return results;\n  }\n\n  /**\n   * Returns possible results of the simulation.\n   */\n  simulate(): AttackBranch[] {\n    const branches: AttackBranch[] = Array(this.config.iterations);\n    for (let i = 0; i < branches.length; i++) {\n      const results = this.generateAttackDice().map((d) => d.roll(this.rng));\n      branches[i] = new AttackBranch(\n        this.rng,\n        results,\n        this.config.attackModifiers,\n      );\n    }\n    return branches;\n  }\n}\n","import React from 'react';\nimport { Table } from 'antd';\n\nimport './Breakdown.scss';\n\nimport * as stats from 'simple-statistics';\nimport { AttackBranch, DefenseDie, DefenseStats } from '../../app/simulation';\n\ninterface Defender extends DefenseStats {\n  name: string;\n}\n\n// TODO: Make customizable.\nconst defending: Defender[] = [\n  // Used as a benchmark for a unit that never rolls saves.\n  { name: 'Expected Hits', dice: DefenseDie.none() },\n\n  // Sample units.\n  { name: 'B1 Battle Droid', dice: DefenseDie.white() },\n  { name: 'B2 Battle Droid', dice: DefenseDie.white(), armor: 1 },\n  { name: 'Rebel Trooper', dice: DefenseDie.white(), surges: true },\n  { name: 'Stormtrooper', dice: DefenseDie.red() },\n  { name: 'Deathtrooper', dice: DefenseDie.red(), surges: true },\n  { name: 'Rebel AT-RT', dice: DefenseDie.white(), armor: true },\n  {\n    name: 'X-34 Landpseeder',\n    dice: DefenseDie.white(),\n    surges: true,\n    armor: 2,\n  },\n  { name: 'AT-ST', dice: DefenseDie.white(), surges: true, armor: true },\n  { name: 'Dewback Rider', dice: DefenseDie.red(), armor: 1 },\n  { name: 'Occupier Tank', dice: DefenseDie.red(), armor: true },\n];\n\nexport default (props: {\n  mods: {\n    impact: number;\n  };\n  data: AttackBranch[];\n}) => {\n  // Aggregate results per defending unit.\n  const results: Array<{\n    key: string;\n    cover0: string;\n    cover1: string;\n    cover2: string;\n  }> = [];\n\n  for (const defender of defending) {\n    let woundsByCoverAmount: number[][] = [[], [], []];\n\n    // For each amount of cover.\n    for (let cover = 0; cover < woundsByCoverAmount.length; cover++) {\n      // For each attacking dice pool.\n      for (const branch of props.data) {\n        // Add the number of expected wounds (v cover + defender).\n        woundsByCoverAmount[cover].push(branch.hits(cover, defender).wounds());\n      }\n    }\n\n    const expectedWounds = woundsByCoverAmount.map((w) =>\n      stats.mean(w).toFixed(2),\n    );\n\n    results.push({\n      key: defender.name,\n      cover0: expectedWounds[0],\n      cover1: expectedWounds[1],\n      cover2: expectedWounds[2],\n    });\n  }\n\n  // Add the expected hits independent of the defending unit.\n\n  return (\n    <Table\n      bordered\n      columns={[\n        { title: 'Defending', key: 'nakeyme', dataIndex: 'key' },\n        { title: 'No Cover', key: 'cover0', dataIndex: 'cover0' },\n        { title: 'Cover 1', key: 'cover1', dataIndex: 'cover1' },\n        { title: 'Cover 2', key: 'cover2', dataIndex: 'cover2' },\n      ]}\n      dataSource={results}\n      pagination={false}\n      size={'small'}\n    ></Table>\n  );\n};\n","import React from 'react';\nimport { VictoryChart, VictoryBar, VictoryAxis } from 'victory';\nimport Breakdown from './Output/Breakdown';\nimport { SimConfig } from '../app/state';\nimport { Simulation } from '../app/simulation';\n\nexport default (props: { simulate: SimConfig }) => {\n  const data = new Simulation(props.simulate).simulate();\n  const grouped: { [key: number]: number } = {};\n  const ticks = new Set<number>();\n  for (const result of data) {\n    const hits = result.rawTotalHits;\n    grouped[hits] = (grouped[hits] || 0) + 1;\n    ticks.add(hits);\n  }\n  return (\n    <>\n      <VictoryChart\n        animate={{ duration: 1000 }}\n        domainPadding={{ x: 15 }}\n        height={200}\n      >\n        <VictoryBar\n          data={Object.entries(grouped).map((value) => {\n            return { x: value[0], y: value[1] };\n          })}\n          labels={({ datum }) =>\n            `${((datum.y / data.length) * 100).toFixed(0)}%`\n          }\n          style={{\n            data: {\n              fill: 'tomato',\n            },\n          }}\n        />\n        <VictoryAxis\n          style={{\n            axisLabel: { padding: 30 },\n          }}\n        />\n      </VictoryChart>\n      <Breakdown\n        data={data}\n        mods={{\n          impact: props.simulate.attackModifiers.impact,\n        }}\n      />\n    </>\n  );\n};\n","import React from 'react';\nimport { Form, Select, InputNumber } from 'antd';\nimport { AttackDiceModifiers } from '../app/state';\n\nconst { Option } = Select;\n\nexport default (props: {\n  modifiers: AttackDiceModifiers;\n  onChanged: (newModifiers: AttackDiceModifiers) => void;\n}) => {\n  return (\n    <Form\n      labelCol={{\n        xs: { span: 24 },\n        sm: { span: 8 },\n      }}\n    >\n      <Form.Item label=\"Surge\">\n        <Select\n          value={props.modifiers.surge}\n          onChange={(value) => {\n            props.onChanged({\n              ...props.modifiers,\n              surge: value,\n            });\n          }}\n        >\n          <Option value=\"none\">None</Option>\n          <Option value=\"hit\">Hit</Option>\n          <Option value=\"crit\">Crit</Option>\n        </Select>\n      </Form.Item>\n      <Form.Item label=\"Impact\">\n        <InputNumber\n          value={props.modifiers.impact}\n          min={0}\n          onChange={(value) => {\n            props.onChanged({\n              ...props.modifiers,\n              impact: value === 0 ? 0 : value || props.modifiers.impact,\n            });\n          }}\n        />\n      </Form.Item>\n    </Form>\n  );\n};\n","import React from 'react';\nimport { Slider } from 'antd';\n\nimport App from '../app/App';\n\nfunction iterationsToSlider(iterations: number): number {\n  return iterations.toString().length - 1;\n}\n\nfunction slideToIterations(slider: number): number {\n  switch (slider) {\n    case 1:\n      return 10;\n    case 2:\n      return 100;\n    case 3:\n      return 1000;\n    case 4:\n      return 10000;\n    case 5:\n      return 100000;\n    default:\n      return App.defaultState.iterations;\n  }\n}\n\nexport default function (props: {\n  value: number;\n  onChanged: (value: number) => void;\n}) {\n  return (\n    <Slider\n      min={1}\n      max={5}\n      marks={{\n        1: '10',\n        3: '1000',\n        5: '100000',\n      }}\n      value={iterationsToSlider(props.value)}\n      tipFormatter={slideToIterations}\n      onChange={(value) => props.onChanged(slideToIterations(value as number))}\n    ></Slider>\n  );\n}\n","import React from 'react';\nimport { Row, Col, Input, Button } from 'antd';\nimport { SyncOutlined } from '@ant-design/icons';\nimport Prando from 'prando';\n\nexport default function (props: {\n  value: string;\n  onChanged: (value: string) => void;\n}) {\n  return (\n    <Row>\n      <Col span={18}>\n        <Input\n          value={props.value}\n          maxLength={10}\n          onChange={(v) => props.onChanged(v.target.value)}\n        />\n      </Col>\n      <Col span={2} offset={2}>\n        <Button\n          icon={<SyncOutlined />}\n          title=\"Randomize\"\n          onClick={() => props.onChanged(new Prando().nextString(10))}\n        />\n      </Col>\n    </Row>\n  );\n}\n","import React from 'react';\nimport GitInfo from 'react-git-info/macro';\nimport { Layout, Card, Form, Button, Row, Col } from 'antd';\nimport { SettingOutlined, StarOutlined, EditOutlined } from '@ant-design/icons';\n\nimport './App.scss';\n\nimport { SimConfig, encodeConfig, decodeConfig } from './state';\nimport Pool from '../ui/Pool';\nimport Output from '../ui/Output';\nimport Modifiers from '../ui/Modifiers';\nimport IterationSlider from '../ui/IterationSlider';\nimport Prando from 'prando';\nimport SeedInput from '../ui/SeedInput';\n\nconst { Sider } = Layout;\n\nclass App extends React.Component<{}, SimConfig> {\n  public static readonly defaultState: SimConfig = Object.freeze({\n    attackPool: {\n      red: 1,\n      black: 1,\n      white: 1,\n    },\n    attackModifiers: {\n      impact: 0,\n      surge: 'none',\n    },\n    iterations: 10000,\n    rngSeed: `${new Prando().nextString(10)}`,\n  });\n\n  private static readonly defaultEncodedState = encodeConfig(App.defaultState);\n  private static readonly shortHash = GitInfo().commit.shortHash;\n\n  constructor(props: {}) {\n    super(props);\n    const state = JSON.parse(JSON.stringify(App.defaultState));\n    this.state = { ...state, ...decodeConfig(window.location.hash) };\n  }\n\n  encodeStateIfChanged() {\n    const encodedState = encodeConfig(this.state);\n    if (encodedState === App.defaultEncodedState) {\n      window.location.hash = '';\n    } else {\n      window.location.hash = encodedState;\n    }\n  }\n\n  render() {\n    this.encodeStateIfChanged();\n    return (\n      <Layout style={{ minHeight: '100vh', height: '100%' }}>\n        <Sider\n          breakpoint=\"lg\"\n          collapsedWidth=\"0\"\n          width=\"250px\"\n          style={{ minHeight: '100vh', height: '100%' }}\n        >\n          <div className=\"logo\">\n            <strong>RollCrits</strong> #{App.shortHash}\n          </div>\n          <Card\n            title={\n              <span>\n                <SettingOutlined />\n                <span> Settings</span>\n              </span>\n            }\n          >\n            <Form layout=\"vertical\">\n              <Form.Item label=\"Iterations\">\n                <IterationSlider\n                  value={this.state.iterations}\n                  onChanged={(value) => this.setState({ iterations: value })}\n                />\n              </Form.Item>\n              <Form.Item label=\"RNG Seed\">\n                <SeedInput\n                  value={this.state.rngSeed}\n                  onChanged={(value) => this.setState({ rngSeed: value })}\n                />\n              </Form.Item>\n              <Row>\n                <Col span={24}>\n                  <Button\n                    block\n                    disabled={!window.location.hash}\n                    type=\"danger\"\n                    onClick={() => {\n                      this.setState(App.defaultState);\n                    }}\n                  >\n                    Reset\n                  </Button>\n                </Col>\n              </Row>\n            </Form>\n          </Card>\n          <Card\n            title={\n              <span>\n                <StarOutlined />\n                <span> Dice</span>\n              </span>\n            }\n          >\n            <Pool\n              dice={this.state.attackPool}\n              onChanged={(newDice) => {\n                this.setState({\n                  attackPool: newDice,\n                });\n              }}\n            />\n          </Card>\n          <Card\n            title={\n              <span>\n                <EditOutlined />\n                <span> Modifiers</span>\n              </span>\n            }\n          >\n            <Modifiers\n              modifiers={this.state.attackModifiers}\n              onChanged={(newModifiers) => {\n                this.setState({\n                  attackModifiers: newModifiers,\n                });\n              }}\n            />\n          </Card>\n        </Sider>\n        <Layout>\n          <Layout.Content style={{ margin: '24px 16px 0' }}>\n            <div className=\"content-module\">\n              <Output simulate={this.state} />\n            </div>\n          </Layout.Content>\n        </Layout>\n      </Layout>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.scss';\nimport App from './app/App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}