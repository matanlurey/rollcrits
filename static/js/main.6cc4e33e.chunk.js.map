{"version":3,"sources":["state/state.ts","ui/Pool.tsx","calc/simulate.ts","ui/Output/Breakdown.tsx","ui/Output.tsx","ui/Modifiers.tsx","App.tsx","index.tsx"],"names":["encodeConfig","config","btoa","JSON","stringify","DiceInput","props","Item","label","value","count","min","onChange","Number","isInteger","AttackDiceSide","Pool","dice","this","labelCol","xs","span","sm","red","v","updateDice","black","white","newPool","onChanged","React","Component","defending","name","toWound","armor","avgHits","stats","data","map","d","netHits","avgCrits","netCrits","results","defender","hits","crits","Math","max","mods","impact","total","cover0","cover1","cover2","push","key","toFixed","bordered","columns","title","dataIndex","dataSource","pagination","size","diceTable","crit","surge","hit","blank","configuration","random","Prando","useRandomSeed","undefined","i","iterations","rolled","attackPool","nextArrayItem","roll","attackModifiers","simulate","grouped","ticks","Set","result","add","animate","duration","domainPadding","x","height","Object","entries","y","labels","datum","length","style","fill","axisLabel","padding","Breakdown","Option","Select","modifiers","Sider","Layout","App","state","parse","defaultState","fragment","urlState","window","location","hash","indexOf","substring","atob","decodeConfig","encodedState","defaultEncodedState","toString","slider","encodeStateIfChanged","breakpoint","collapsedWidth","width","className","shortHash","SettingOutlined","layout","marks","1","3","5","iterationsToSlider","tipFormatter","slideToIterations","bind","setState","checkedChildren","CheckOutlined","unCheckedChildren","CloseOutlined","checked","StarOutlined","newDice","EditOutlined","Modifiers","newModifiers","Content","margin","Output","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.6cc4e33e.chunk.js","sourcesContent":["/**\n * Simulation-wide state (or configuration).\n */\nexport interface SimConfig {\n  /**\n   * Attacking dice pool.\n   */\n  attackPool: AttackDiceConfig;\n\n  /**\n   * Attacking dice pool modifiers.\n   */\n  attackModifiers: AttackDiceModifiers;\n\n  /**\n   * Number of times the dice should be rolled.\n   */\n  iterations: number;\n\n  /**\n   * Whether to use a random seed for simulations.\n   */\n  useRandomSeed: boolean;\n}\n\n/**\n * Encodes the provided configuration as base-64 encoded string.\n *\n * @param config\n */\nexport function encodeConfig(config: SimConfig): string {\n  return btoa(JSON.stringify(config));\n}\n\n/**\n * Decodes the provided hash-fragment URL into a config.\n *\n * Returns {undefined} if there was no stored configuration.\n */\nexport function decodeConfig(fragment: string): SimConfig | undefined {\n  let urlState = window.location.hash;\n  if (urlState) {\n    const fragment = urlState.indexOf('#');\n    if (fragment !== -1) {\n      urlState = urlState.substring(fragment + 1);\n    }\n    if (urlState && urlState.length) {\n      return JSON.parse(atob(urlState));\n    }\n  }\n  return undefined;\n}\n\nexport interface AttackDiceConfig {\n  /**\n   * Number of red dice.\n   */\n  red: number;\n\n  /**\n   * Number of black dice.\n   */\n  black: number;\n\n  /**\n   * Number of white dice.\n   */\n  white: number;\n}\n\nexport interface AttackDiceModifiers {\n  /**\n   * What the `surge` icon the dice should convert to.\n   */\n  surge: 'none' | 'hit' | 'crit';\n\n  /**\n   * How much impact the dice pool has.\n   */\n  impact: number;\n}\n","import React from 'react';\nimport { Form, InputNumber } from 'antd';\nimport { AttackDiceConfig } from '../state/state';\n\nfunction DiceInput(props: {\n  label: React.ReactNode;\n  count: number;\n  onChange: (count: number) => void;\n}) {\n  return (\n    <Form.Item label={props.label}>\n      <InputNumber\n        value={props.count}\n        min={0}\n        onChange={(value = 0) => {\n          props.onChange(Number.isInteger(value) ? value : props.count);\n        }}\n      ></InputNumber>\n    </Form.Item>\n  );\n}\n\nexport default class Pool extends React.Component<PoolProps> {\n  render() {\n    const dice = this.props.dice;\n    return (\n      <Form\n        labelCol={{\n          xs: { span: 24 },\n          sm: { span: 8 },\n        }}\n      >\n        <DiceInput\n          label=\"Red\"\n          count={dice.red}\n          onChange={(v: number) => this.updateDice({ red: v })}\n        />\n        <DiceInput\n          label=\"Black\"\n          count={dice.black}\n          onChange={(v: number) => this.updateDice({ black: v })}\n        />\n        <DiceInput\n          label=\"White\"\n          count={dice.white}\n          onChange={(v: number) => this.updateDice({ white: v })}\n        />\n      </Form>\n    );\n  }\n\n  updateDice(newPool: Partial<AttackDiceConfig>) {\n    this.props.onChanged({ ...this.props.dice, ...newPool });\n  }\n}\n\nexport interface PoolProps {\n  readonly dice: AttackDiceConfig;\n  readonly onChanged: (pool: AttackDiceConfig) => void;\n}\n","import Prando from 'prando';\n\nimport { SimConfig } from '../state/state';\n\nexport interface Results {\n  impact: number;\n  netHits: number;\n  netCrits: number;\n}\n\nexport enum AttackDiceSide {\n  blank,\n  surge,\n  hit,\n  crit,\n}\n\nconst diceTable = {\n  white: [\n    AttackDiceSide.crit,\n    AttackDiceSide.surge,\n    AttackDiceSide.hit,\n    AttackDiceSide.blank,\n    AttackDiceSide.blank,\n    AttackDiceSide.blank,\n    AttackDiceSide.blank,\n    AttackDiceSide.blank,\n  ],\n\n  black: [\n    AttackDiceSide.crit,\n    AttackDiceSide.surge,\n    AttackDiceSide.hit,\n    AttackDiceSide.hit,\n    AttackDiceSide.hit,\n    AttackDiceSide.blank,\n    AttackDiceSide.blank,\n    AttackDiceSide.blank,\n  ],\n\n  red: [\n    AttackDiceSide.crit,\n    AttackDiceSide.surge,\n    AttackDiceSide.hit,\n    AttackDiceSide.hit,\n    AttackDiceSide.hit,\n    AttackDiceSide.hit,\n    AttackDiceSide.hit,\n    AttackDiceSide.blank,\n  ],\n};\n\nexport function simulate(configuration: SimConfig): Results[] {\n  const results: Results[] = [];\n\n  // TODO: Make seed configurable, perhaps stored locally only.\n  const random = new Prando(\n    configuration.useRandomSeed ? undefined : '1734176512',\n  );\n\n  for (let i = 0; i < configuration.iterations; i++) {\n    // Aggregate results.\n    const rolled: AttackDiceSide[] = [];\n\n    // Roll dice.\n    for (let d = 0; d < configuration.attackPool.red; d++) {\n      rolled.push(random.nextArrayItem(diceTable.red));\n    }\n    for (let d = 0; d < configuration.attackPool.black; d++) {\n      rolled.push(random.nextArrayItem(diceTable.black));\n    }\n    for (let d = 0; d < configuration.attackPool.white; d++) {\n      rolled.push(random.nextArrayItem(diceTable.white));\n    }\n\n    // Determine results.\n    let netHits = 0;\n    let netCrits = 0;\n    for (const roll of rolled) {\n      if (roll === AttackDiceSide.crit) {\n        netCrits++;\n      } else if (roll === AttackDiceSide.hit) {\n        netHits++;\n      } else if (roll === AttackDiceSide.surge) {\n        if (configuration.attackModifiers.surge === 'crit') {\n          netCrits++;\n        } else if (configuration.attackModifiers.surge === 'hit') {\n          netHits++;\n        }\n      }\n    }\n\n    results.push({\n      impact: configuration.attackModifiers.impact,\n      netHits: netHits,\n      netCrits: netCrits,\n    });\n  }\n\n  return results;\n}\n","import React from 'react';\nimport { Table } from 'antd';\nimport * as stats from 'simple-statistics';\n\n// TODO: Make customizable.\nconst defending = [\n  { name: 'B1 Battle Droid', toWound: 5 / 6, armor: false },\n  { name: 'B2 Battle Droid', toWound: 5 / 6, armor: 1 },\n  { name: 'Rebel Trooper', toWound: 4 / 6, armor: false },\n  { name: 'Stormtrooper', toWound: 3 / 6, armor: false },\n  { name: 'Deathtrooper', toWound: 2 / 6, armor: false },\n  { name: 'Rebel AT-RT', toWound: 5 / 6, armor: true },\n  { name: 'X-34 Landpseeder', toWound: 4 / 6, armor: 2 },\n  { name: 'T-47 Airspeeder', toWound: 4 / 6, armor: true },\n  { name: 'Dewback Rider', toWound: 3 / 6, armor: 1 },\n  { name: 'Occupier Tank', toWound: 3 / 6, armor: true },\n];\n\nexport default (props: {\n  mods: {\n    impact: number;\n  };\n  data: Array<{\n    netHits: number;\n    netCrits: number;\n  }>;\n}) => {\n  // Determine average # of hits and crits.\n  const avgHits = stats.mean(props.data.map((d) => d.netHits));\n  const avgCrits = stats.mean(props.data.map((d) => d.netCrits));\n\n  // Aggregate results per defending unit.\n  const results: Array<{\n    key: string;\n    name: string;\n    cover0: string;\n    cover1: string;\n    cover2: string;\n  }> = [];\n\n  for (const defender of defending) {\n    let hits = avgHits;\n    let crits = avgCrits;\n\n    if (defender.armor) {\n      if (defender.armor === true) {\n        // As many hits as you have impact, discard rest of hits.\n        hits = Math.max(0, props.mods.impact);\n      } else {\n        // Minimum number of hits is impact, max is hits - armor.\n        hits = Math.max(props.mods.impact, hits - defender.armor);\n      }\n    }\n\n    const total = hits + crits;\n    const cover0 = Math.max(0, total - 0) * defender.toWound;\n    const cover1 = Math.max(0, total - 1) * defender.toWound;\n    const cover2 = Math.max(0, total - 2) * defender.toWound;\n\n    results.push({\n      key: defender.name,\n      name: defender.name,\n      cover0: cover0.toFixed(1),\n      cover1: cover1.toFixed(1),\n      cover2: cover2.toFixed(1),\n    });\n  }\n\n  // Add\n  return (\n    <Table\n      bordered\n      columns={[\n        { title: 'Defending', key: 'name', dataIndex: 'name' },\n        { title: 'No Cover', key: 'cover0', dataIndex: 'cover0' },\n        { title: 'Cover 1', key: 'cover1', dataIndex: 'cover1' },\n        { title: 'Cover 2', key: 'cover2', dataIndex: 'cover2' },\n      ]}\n      dataSource={results}\n      pagination={false}\n      size={'small'}\n    ></Table>\n  );\n};\n","import React from 'react';\nimport { VictoryChart, VictoryBar, VictoryAxis } from 'victory';\nimport * as stats from 'simple-statistics';\nimport Breakdown from './Output/Breakdown';\nimport { SimConfig } from '../state/state';\nimport { simulate } from '../calc/simulate';\n\nexport default (props: { simulate: SimConfig }) => {\n  const data = simulate(props.simulate);\n  const grouped: { [key: number]: number } = {};\n  const ticks = new Set<number>();\n  for (const result of data) {\n    const hits = result.netCrits + result.netHits;\n    grouped[hits] = (grouped[hits] || 0) + 1;\n    ticks.add(hits);\n  }\n  return (\n    <>\n      <VictoryChart\n        animate={{ duration: 1000 }}\n        domainPadding={{ x: 15 }}\n        height={200}\n      >\n        <VictoryBar\n          data={Object.entries(grouped).map((value) => {\n            return { x: value[0], y: value[1] };\n          })}\n          labels={({ datum }) =>\n            `${((datum.y / data.length) * 100).toFixed(0)}%`\n          }\n          style={{\n            data: {\n              fill: 'tomato',\n            },\n          }}\n        />\n        <VictoryAxis\n          label={`μ Hits: ${stats\n            .mean(data.map((d) => d.netHits + d.netCrits))\n            .toFixed(1)}`}\n          style={{\n            axisLabel: { padding: 30 },\n          }}\n        />\n      </VictoryChart>\n      <Breakdown\n        data={data}\n        mods={{\n          impact: props.simulate.attackModifiers.impact,\n        }}\n      />\n    </>\n  );\n};\n","import React from 'react';\nimport { Form, Select, InputNumber } from 'antd';\nimport { AttackDiceModifiers } from '../state/state';\n\nconst { Option } = Select;\n\nexport default (props: {\n  modifiers: AttackDiceModifiers;\n  onChanged: (newModifiers: AttackDiceModifiers) => void;\n}) => {\n  return (\n    <Form\n      labelCol={{\n        xs: { span: 24 },\n        sm: { span: 8 },\n      }}\n    >\n      <Form.Item label=\"Surge\">\n        <Select\n          value={props.modifiers.surge}\n          onChange={(value) => {\n            props.onChanged({\n              ...props.modifiers,\n              surge: value,\n            });\n          }}\n        >\n          <Option value=\"none\">None</Option>\n          <Option value=\"hit\">Hit</Option>\n          <Option value=\"crit\">Crit</Option>\n        </Select>\n      </Form.Item>\n      <Form.Item label=\"Impact\">\n        <InputNumber\n          value={props.modifiers.impact}\n          min={0}\n          onChange={(value) => {\n            props.onChanged({\n              ...props.modifiers,\n              impact: value === 0 ? 0 : value || props.modifiers.impact,\n            });\n          }}\n        />\n      </Form.Item>\n    </Form>\n  );\n};\n","import React from 'react';\nimport GitInfo from 'react-git-info/macro';\nimport { Layout, Card, Slider, Switch, Form } from 'antd';\nimport './App.scss';\nimport { SimConfig, encodeConfig, decodeConfig } from './state/state';\nimport {\n  SettingOutlined,\n  StarOutlined,\n  EditOutlined,\n  CheckOutlined,\n  CloseOutlined,\n} from '@ant-design/icons';\nimport Pool from './ui/Pool';\nimport Output from './ui/Output';\nimport Modifiers from './ui/Modifiers';\n\nconst { Sider } = Layout;\n\nclass App extends React.Component<{}, SimConfig> {\n  private static readonly defaultState: SimConfig = {\n    attackPool: {\n      red: 1,\n      black: 1,\n      white: 1,\n    },\n    attackModifiers: {\n      impact: 0,\n      surge: 'none',\n    },\n    iterations: 10000,\n    useRandomSeed: true,\n  };\n\n  private static readonly defaultEncodedState = encodeConfig(App.defaultState);\n  private static readonly shortHash = GitInfo().commit.shortHash;\n\n  constructor(props: {}) {\n    super(props);\n    const state = JSON.parse(JSON.stringify(App.defaultState));\n    this.state = { ...state, ...decodeConfig(window.location.hash) };\n  }\n\n  encodeStateIfChanged() {\n    const encodedState = encodeConfig(this.state);\n    if (encodedState === App.defaultEncodedState) {\n      window.location.hash = '';\n    } else {\n      window.location.hash = encodedState;\n    }\n  }\n\n  private iterationsToSlider(iterations: number): number {\n    return iterations.toString().length - 1;\n  }\n\n  private slideToIterations(slider: number): number {\n    switch (slider) {\n      case 1:\n        return 10;\n      case 2:\n        return 100;\n      case 3:\n        return 1000;\n      case 4:\n        return 10000;\n      case 5:\n        return 100000;\n      default:\n        return App.defaultState.iterations;\n    }\n  }\n\n  render() {\n    this.encodeStateIfChanged();\n    return (\n      <Layout style={{ height: '100vh' }}>\n        <Sider breakpoint=\"lg\" collapsedWidth=\"0\" width=\"250px\">\n          <div className=\"logo\">\n            <strong>RollCrits</strong> #{App.shortHash}\n          </div>\n          <Card\n            title={\n              <span>\n                <SettingOutlined />\n                <span> Settings</span>\n              </span>\n            }\n          >\n            <Form layout=\"vertical\">\n              <Form.Item label=\"Iterations\">\n                <Slider\n                  min={1}\n                  max={5}\n                  marks={{\n                    1: '10',\n                    3: '1000',\n                    5: '100000',\n                  }}\n                  value={this.iterationsToSlider(this.state.iterations)}\n                  tipFormatter={this.slideToIterations.bind(this)}\n                  onChange={(value) =>\n                    this.setState({\n                      iterations: this.slideToIterations(value as number),\n                    })\n                  }\n                ></Slider>\n              </Form.Item>\n              <Form.Item label=\"Random Seed\">\n                <Switch\n                  checkedChildren={<CheckOutlined />}\n                  unCheckedChildren={<CloseOutlined />}\n                  checked={this.state.useRandomSeed}\n                  onChange={(value) =>\n                    this.setState({\n                      useRandomSeed: !!value,\n                    })\n                  }\n                />\n              </Form.Item>\n            </Form>\n          </Card>\n          <Card\n            title={\n              <span>\n                <StarOutlined />\n                <span> Dice</span>\n              </span>\n            }\n          >\n            <Pool\n              dice={this.state.attackPool}\n              onChanged={(newDice) => {\n                this.setState({\n                  attackPool: newDice,\n                });\n              }}\n            />\n          </Card>\n          <Card\n            title={\n              <span>\n                <EditOutlined />\n                <span> Modifiers</span>\n              </span>\n            }\n          >\n            <Modifiers\n              modifiers={this.state.attackModifiers}\n              onChanged={(newModifiers) => {\n                this.setState({\n                  attackModifiers: newModifiers,\n                });\n              }}\n            />\n          </Card>\n        </Sider>\n        <Layout>\n          <Layout.Content style={{ margin: '24px 16px 0' }}>\n            <div className=\"content-module\">\n              <Output simulate={this.state} />\n            </div>\n          </Layout.Content>\n        </Layout>\n      </Layout>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.scss';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}