(this.webpackJsonprollcrits=this.webpackJsonprollcrits||[]).push([[0],{296:function(e,t,a){e.exports=a(510)},301:function(e,t,a){},302:function(e,t,a){},406:function(e,t,a){},510:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(16),c=a.n(i),l=(a(301),a(48)),o=a(43),s=a(44),u=a(111),m=a(108),h=a(519),d=a(522),f=a(521),g=a(116),b=a(50),p=a(56),v=a(535),k=a(541),E=a(536),w=a(538),y=(a(302),a(74));(new y.a).nextString(10);function O(e){return btoa(JSON.stringify(e))}var C=a(529);function S(e){return r.a.createElement(f.a.Item,{label:e.label},r.a.createElement(C.a,{value:e.count,min:0,onChange:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e.onChange(Number.isInteger(t)?t:e.count)}}))}var j,x,I=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.props.dice;return r.a.createElement(f.a,{labelCol:{xs:{span:24},sm:{span:12}}},r.a.createElement(S,{label:"Red",count:t.red,onChange:function(t){return e.updateDice({red:t})}}),r.a.createElement(S,{label:"Black",count:t.black,onChange:function(t){return e.updateDice({black:t})}}),r.a.createElement(S,{label:"White",count:t.white,onChange:function(t){return e.updateDice({white:t})}}))}},{key:"updateDice",value:function(e){this.props.onChanged(Object(l.a)({},this.props.dice,{},e))}}]),a}(r.a.Component),D=a(84),N=a(528),A=a(527),R=a(533),T=a(520),F=a(532),B=a(292),H=(a(406),a(261));!function(e){e.blank="blank",e.surge="surge",e.hit="hit",e.crit="crit"}(j||(j={})),function(e){e.blank="blank",e.surge="surge",e.block="block"}(x||(x={}));var J={white:[j.crit,j.surge,j.hit,j.blank,j.blank,j.blank,j.blank,j.blank],black:[j.crit,j.surge,j.hit,j.hit,j.hit,j.blank,j.blank,j.blank],red:[j.crit,j.surge,j.hit,j.hit,j.hit,j.hit,j.hit,j.blank]},M={white:[x.block,x.surge,x.blank,x.blank,x.blank,x.blank],red:[x.block,x.block,x.block,x.surge,x.blank,x.blank]},P=function(){function e(t,a){Object(o.a)(this,e),this.sides=t,this.order=a}return Object(s.a)(e,[{key:"roll",value:function(e){return e.nextArrayItem(this.sides)}}]),e}();P.red=new P(J.red,3),P.black=new P(J.black,3),P.white=new P(J.white,3);var z=function(){function e(t){Object(o.a)(this,e),this.sides=t}return Object(s.a)(e,[{key:"roll",value:function(e){return e.nextArrayItem(this.sides)}}]),e}();z.red=new z(M.red),z.white=new z(M.white),z.none=new z([x.blank]);var L=function(){function e(t,a,n,r){Object(o.a)(this,e),this.rng=t,this.result=a,this.modifiers=n,this.tokens=r}return Object(s.a)(e,[{key:"aggregateDice",value:function(){var e,t=0,a=0,n=this.modifiers.critical,r=this.tokens.surge,i=Object(D.a)(this.result);try{for(i.s();!(e=i.n()).done;){var c=e.value.roll;switch(c===j.surge&&(n?(c=j.crit,n--):"blank"!==this.modifiers.surge&&r?(c=j.hit,r--):c=this.modifiers.surge),c){case j.crit:a++;break;case j.hit:t++;break;case j.blank:}}}catch(l){i.e(l)}finally{i.f()}return{hits:t,crits:a}}},{key:"hits",value:function(e,t){var a=this.aggregateDice(),n=a.hits,r=a.crits;if(n=Math.max(0,n-e),t.armor){var i=Math.min(n,this.modifiers.impact);n-=i,r+=i,n=!0===t.armor?0:Math.max(0,n-t.armor)}return new U(this.rng,n+r,t,this.modifiers.pierce)}},{key:"rawTotalHits",get:function(){var e=this.aggregateDice();return e.hits+e.crits}}]),e}(),U=function(){function e(t,a,n,r){Object(o.a)(this,e),this.rng=t,this.hits=a,this.stats=n,this.pierce=r}return Object(s.a)(e,[{key:"generateDefenseDice",value:function(){var e=this.hits;return"impervious"===this.stats.pierce&&(e+=this.pierce),Array(e).fill(this.stats.dice)}},{key:"wounds",value:function(){var e,t=0,a=Object(D.a)(this.generateDefenseDice());try{for(a.s();!(e=a.n()).done;){switch(e.value.roll(this.rng)){case x.block:t++;break;case x.surge:this.stats.surges&&t++;break;case x.blank:}}}catch(n){a.e(n)}finally{a.f()}return this.pierce&&"immune"!==this.stats.pierce&&(t=Math.max(0,t-this.pierce)),Math.max(0,this.hits-t)}}]),e}(),W=function(){function e(t){Object(o.a)(this,e),this.config=t,this.rng=void 0,this.rng=new y.a(t.rngSeed)}return Object(s.a)(e,[{key:"generateAttackDice",value:function(){for(var e=[],t=this.config.pool,a=0;a<t.red;a++)e.push(P.red);for(var n=0;n<t.black;n++)e.push(P.black);for(var r=0;r<t.white;r++)e.push(P.white);return e}},{key:"staticSortDice",value:function(e,t){}},{key:"simulate",value:function(){for(var e=this,t=Array(this.config.iterations),a=0;a<t.length;a++){var n=this.generateAttackDice().map((function(t){return{dice:t,roll:t.roll(e.rng)}})).sort((function(e,t){return e.dice.order-t.dice.order}));t[a]=new L(this.rng,n,this.config.modifiers,this.config.tokens)}return t}}]),e}(),q=a(276),G=a.n(q),V=a(133),X=a.n(V),K=a(539),Q=[{name:"B1 Battle Droid",dice:z.white},{name:"B2 Battle Droid",dice:z.white,armor:1},{name:"Rebel Trooper",dice:z.white,surges:!0},{name:"Stormtrooper",dice:z.red},{name:"Deathtrooper",dice:z.red,surges:!0},{name:"Boba Fett",dice:z.red,surges:!0,pierce:"impervious"},{name:"Darth Vader",dice:z.red,pierce:"immune"},{name:"Emperor Palpatine",dice:z.red,pierce:"immune",surges:!0},{name:"Rebel AT-RT",dice:z.white,armor:!0},{name:"X-34 Landpseeder",dice:z.white,surges:!0,armor:2},{name:"AT-ST",dice:z.white,surges:!0,armor:!0},{name:"Dewback Rider",dice:z.red,armor:1},{name:"Occupier Tank",dice:z.red,armor:!0}];function Y(e,t){return Number.parseFloat(e)-Number.parseFloat(t)}var Z=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={showUnitStats:!0},n}return Object(s.a)(a,[{key:"render",value:function(){var e,t=this,a=[],n=Object(D.a)(Q);try{for(n.s();!(e=n.n()).done;){for(var i=e.value,c=[[],[],[]],l=0;l<c.length;l++){var o,s=Object(D.a)(this.props.data);try{for(s.s();!(o=s.n()).done;){var u=o.value;c[l].push(u.hits(l,i).wounds())}}catch(h){s.e(h)}finally{s.f()}}var m=c.map((function(e){return H.mean(e).toFixed(2)}));a.push({key:i.name,unit:i,cover0:m[0],cover1:m[1],cover2:m[2]})}}catch(h){n.e(h)}finally{n.f()}return r.a.createElement(T.a,{bordered:!0,dataSource:a,pagination:!1,size:"small"},r.a.createElement(X.a,{title:"Defending Unit",dataIndex:"unit",key:"unit",sorter:function(e,t){return function(e,t){return e>t?1:e<t?-1:0}(e.name,t.name)},render:function(e){return r.a.createElement(g.a,null,r.a.createElement(b.a,{span:24},e.name),r.a.createElement(B.a,{query:"(min-width: 499px)",render:function(){return r.a.createElement(b.a,{span:24,hidden:!t.state.showUnitStats},function(e){var t=[r.a.createElement(F.a,{color:e.dice===z.red?"red":"default",key:"dice",style:{transform:"scale(0.5) rotate(45deg)"}},"\xa0")];e.surges&&t.push(r.a.createElement(F.a,{color:e.dice===z.red?"red":"default",key:"surges"},"Surge: ",r.a.createElement(K.a,null)," "));e.pierce&&("impervious"===e.pierce?t.push(r.a.createElement(F.a,{color:"volcano",key:"pierce"},r.a.createElement("span",null,"Impervious"))):t.push(r.a.createElement(F.a,{color:"volcano",key:"pierce"},"Immune: Pierce")));e.armor&&(!0===e.armor?t.push(r.a.createElement(F.a,{color:"magenta",key:"armor"},"Armor: ",r.a.createElement("strong",null,"\u221e"))):t.push(r.a.createElement(F.a,{color:"magenta",key:"armor"},"Armor: ",e.armor)));return r.a.createElement(r.a.Fragment,null,t)}(e))}}))}}),r.a.createElement(G.a,{title:"Cover"},r.a.createElement(X.a,{title:"0",dataIndex:"cover0",key:"cover0",sorter:function(e,t){return Y(e,t)}}),r.a.createElement(X.a,{title:"1",dataIndex:"cover1",key:"cover1",sorter:function(e,t){return Y(e,t)}}),r.a.createElement(X.a,{title:"2",dataIndex:"cover2",key:"cover2",sorter:function(e,t){return Y(e,t)}})))}}]),a}(r.a.Component);var $=function(e){var t,a=new W(e.simulate).simulate(),n={},i=new Set,c=Object(D.a)(a);try{for(c.s();!(t=c.n()).done;){var l=t.value.rawTotalHits;n[l]=(n[l]||0)+1,i.add(l)}}catch(o){c.e(o)}finally{c.f()}return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{animate:{duration:1e3},domainPadding:{x:15},height:200},r.a.createElement(A.a,{data:Object.entries(n).map((function(e){return{x:e[0],y:e[1]}})),labels:function(e){var t=e.datum;return"".concat((t.y/a.length*100).toFixed(0),"%")},style:{data:{fill:"tomato"}}}),r.a.createElement(R.a,{style:{axisLabel:{padding:30}}})),r.a.createElement(Z,{data:a,mods:{impact:e.simulate.modifiers.impact}}))},_=a(130),ee=a(518),te=_.a.Option,ae=function(e){return r.a.createElement(f.a,{labelCol:{xs:{span:24},sm:{span:12}}},r.a.createElement(f.a.Item,{label:"Surge"},r.a.createElement(_.a,{value:e.modifiers.surge,onChange:function(t){e.onChanged(Object(l.a)({},e.modifiers,{surge:t}))}},r.a.createElement(te,{value:j.blank},"None"),r.a.createElement(te,{value:j.hit},"Hit"),r.a.createElement(te,{value:j.crit},"Crit"))),r.a.createElement(ee.a,null),r.a.createElement(f.a.Item,{label:"Critical"},r.a.createElement(C.a,{value:e.modifiers.critical,min:0,onChange:function(t){e.onChanged(Object(l.a)({},e.modifiers,{critical:0===t?0:t||e.modifiers.critical}))}})),r.a.createElement(f.a.Item,{label:"Impact"},r.a.createElement(C.a,{value:e.modifiers.impact,min:0,onChange:function(t){e.onChanged(Object(l.a)({},e.modifiers,{impact:0===t?0:t||e.modifiers.impact}))}})),r.a.createElement(f.a.Item,{label:"Pierce"},r.a.createElement(C.a,{value:e.modifiers.pierce,min:0,onChange:function(t){e.onChanged(Object(l.a)({},e.modifiers,{pierce:0===t?0:t||e.modifiers.pierce}))}})))},ne=a(524);function re(e){switch(e){case 1:return 10;case 2:return 100;case 3:return 1e3;case 4:return 1e4;case 5:return 1e5;default:return he.defaultState.iterations}}var ie=function(e){return r.a.createElement(ne.a,{min:1,max:5,marks:{1:"10",3:"1000",5:"100000"},value:(t=e.value,t.toString().length-1),tipFormatter:re,onChange:function(t){return e.onChanged(re(t))}});var t},ce=a(526),le=a(540),oe=function(e){return r.a.createElement(g.a,null,r.a.createElement(b.a,{span:18},r.a.createElement(ce.a,{value:e.value,maxLength:10,onChange:function(t){return e.onChanged(t.target.value)}})),r.a.createElement(b.a,{span:2,offset:2},r.a.createElement(p.a,{icon:r.a.createElement(le.a,null),title:"Randomize",onClick:function(){return e.onChanged((new y.a).nextString(10))}})))},se=function(e){return r.a.createElement(f.a,{labelCol:{xs:{span:24},sm:{span:12}}},r.a.createElement(f.a.Item,{label:"Surge"},r.a.createElement(C.a,{value:e.tokens.surge,min:0,onChange:function(t){e.onChanged(Object(l.a)({},e.tokens,{surge:0===t?0:t||e.tokens.surge}))}})))},ue=h.a.Sider,me=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(o.a)(this,a),n=t.call(this,e);var r=JSON.parse(JSON.stringify(a.defaultState));return n.state=Object(l.a)({},r,{},function(e){var t=window.location.hash;if(t){var a=t.indexOf("#");if(-1!==a&&(t=t.substring(a+1)),t&&t.length&&"default"!==t)return JSON.parse(atob(t))}}(window.location.hash)),n}return Object(s.a)(a,[{key:"encodeStateIfChanged",value:function(){var e=O(this.state);e===a.defaultEncodedState?window.location.hash="default":window.location.hash=e}},{key:"render",value:function(){var e=this;return this.encodeStateIfChanged(),r.a.createElement(h.a,{style:{minHeight:"100vh",height:"100%"}},r.a.createElement(ue,{breakpoint:"lg",collapsedWidth:"0",width:"250px",style:{minHeight:"100vh",height:"100%"}},r.a.createElement("div",{className:"logo"},r.a.createElement("strong",null,"RollCrits")," #",a.shortHash),r.a.createElement(d.a,{title:r.a.createElement("span",null,r.a.createElement(v.a,null),r.a.createElement("span",null," Settings"))},r.a.createElement(f.a,{layout:"vertical"},r.a.createElement(f.a.Item,{label:"Iterations"},r.a.createElement(ie,{value:this.state.iterations,onChanged:function(t){return e.setState({iterations:t})}})),r.a.createElement(f.a.Item,{label:"RNG Seed"},r.a.createElement(oe,{value:this.state.rngSeed,onChanged:function(t){return e.setState({rngSeed:t})}})),r.a.createElement(g.a,null,r.a.createElement(b.a,{span:24},r.a.createElement(p.a,{block:!0,disabled:"#default"===window.location.hash,type:"danger",onClick:function(){e.setState(a.defaultState)}},"Reset"))))),r.a.createElement(d.a,{title:r.a.createElement("span",null,r.a.createElement(k.a,null),r.a.createElement("span",null," Dice"))},r.a.createElement(I,{dice:this.state.pool,onChanged:function(t){e.setState({pool:t})}})),r.a.createElement(d.a,{title:r.a.createElement("span",null,r.a.createElement(E.a,null),r.a.createElement("span",null," Modifiers"))},r.a.createElement(ae,{modifiers:this.state.modifiers,onChanged:function(t){e.setState({modifiers:t})}})),r.a.createElement(d.a,{title:r.a.createElement("span",null,r.a.createElement(w.a,null),r.a.createElement("span",null," Tokens"))},r.a.createElement(se,{tokens:this.state.tokens,onChanged:function(t){e.setState({tokens:t})}}))),r.a.createElement(h.a,null,r.a.createElement(h.a.Content,{style:{margin:"24px 16px 0"}},r.a.createElement("div",{className:"content-module"},r.a.createElement($,{simulate:this.state})))))}}]),a}(r.a.Component);me.defaultState=Object.freeze({pool:{red:1,black:1,white:1},modifiers:{critical:0,impact:0,marksman:!1,pierce:0,precise:0,surge:j.blank},tokens:{surge:0,aim:0,dodge:0},iterations:1e4,rngSeed:"".concat((new y.a).nextString(10))}),me.defaultEncodedState=O(me.defaultState),me.shortHash="54c8bac";var he=me;c.a.render(r.a.createElement(he,null),document.getElementById("root"))}},[[296,1,2]]]);
//# sourceMappingURL=main.53ca7544.chunk.js.map