(this.webpackJsonprollcrits=this.webpackJsonprollcrits||[]).push([[0],{288:function(e,t,a){e.exports=a(501)},293:function(e,t,a){},294:function(e,t,a){},397:function(e,t,a){},501:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(16),c=a.n(i),l=(a(293),a(45)),o=a(54),s=a(41),u=a(157),m=a(153),h=a(510),d=a(513),f=a(512),g=a(111),b=a(47),v=a(55),k=a(528),p=a(527),E=a(529),y=a(526),w=(a(294),a(71));(new w.a).nextString(10);function C(e){return btoa(JSON.stringify(e))}var O=a(520);function S(e){return r.a.createElement(f.a.Item,{label:e.label},r.a.createElement(O.a,{value:e.count,min:0,onChange:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e.onChange(Number.isInteger(t)?t:e.count)}}))}var j,x,D=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.props.dice;return r.a.createElement(f.a,{labelCol:{xs:{span:24},sm:{span:12}}},r.a.createElement(S,{label:"Red",count:t.red,onChange:function(t){return e.updateDice({red:t})}}),r.a.createElement(S,{label:"Black",count:t.black,onChange:function(t){return e.updateDice({black:t})}}),r.a.createElement(S,{label:"White",count:t.white,onChange:function(t){return e.updateDice({white:t})}}))}},{key:"updateDice",value:function(e){this.props.onChanged(Object(l.a)({},this.props.dice,{},e))}}]),a}(r.a.Component),I=a(81),N=a(519),R=a(518),T=a(523),A=a(511),H=(a(397),a(254));!function(e){e.blank="blank",e.surge="surge",e.hit="hit",e.crit="crit"}(j||(j={})),function(e){e.blank="blank",e.surge="surge",e.block="block"}(x||(x={}));var B={white:[j.crit,j.surge,j.hit,j.blank,j.blank,j.blank,j.blank,j.blank],black:[j.crit,j.surge,j.hit,j.hit,j.hit,j.blank,j.blank,j.blank],red:[j.crit,j.surge,j.hit,j.hit,j.hit,j.hit,j.hit,j.blank]},F={white:[x.block,x.surge,x.blank,x.blank,x.blank,x.blank],red:[x.block,x.block,x.block,x.surge,x.blank,x.blank]},J=function(){function e(t,a){Object(o.a)(this,e),this.sides=t,this.order=a}return Object(s.a)(e,null,[{key:"red",value:function(){return new e(B.red,3)}},{key:"black",value:function(){return new e(B.black,2)}},{key:"white",value:function(){return new e(B.white,1)}}]),Object(s.a)(e,[{key:"roll",value:function(e){return e.nextArrayItem(this.sides)}}]),e}(),M=function(){function e(t){Object(o.a)(this,e),this.sides=t}return Object(s.a)(e,null,[{key:"red",value:function(){return new e(F.red)}},{key:"white",value:function(){return new e(F.white)}},{key:"none",value:function(){return new e([x.blank])}}]),Object(s.a)(e,[{key:"roll",value:function(e){return e.nextArrayItem(this.sides)}}]),e}(),z=function(){function e(t,a,n,r){Object(o.a)(this,e),this.rng=t,this.result=a,this.modifiers=n,this.tokens=r}return Object(s.a)(e,[{key:"aggregateDice",value:function(){var e,t=0,a=0,n=this.modifiers.critical,r=this.tokens.surge,i=Object(I.a)(this.result);try{for(i.s();!(e=i.n()).done;){var c=e.value.roll;switch(c===j.surge&&(n?(c=j.crit,n--):"blank"!==this.modifiers.surge&&r?(c=j.hit,r--):c=this.modifiers.surge),c){case j.crit:a++;break;case j.hit:t++;break;case j.blank:}}}catch(l){i.e(l)}finally{i.f()}return{hits:t,crits:a}}},{key:"hits",value:function(e,t){var a=this.aggregateDice(),n=a.hits,r=a.crits;if(n=Math.max(0,n-e),t.armor){var i=Math.min(n,this.modifiers.impact);n-=i,r+=i,n=!0===t.armor?0:Math.max(0,n-t.armor)}return new L(this.rng,n+r,t,this.modifiers.pierce)}},{key:"rawTotalHits",get:function(){var e=this.aggregateDice();return e.hits+e.crits}}]),e}(),L=function(){function e(t,a,n,r){Object(o.a)(this,e),this.rng=t,this.hits=a,this.stats=n,this.pierce=r}return Object(s.a)(e,[{key:"generateDefenseDice",value:function(){var e=this.hits;return"impervious"===this.stats.pierce&&(e+=this.pierce),Array(e).fill(this.stats.dice)}},{key:"wounds",value:function(){var e,t=0,a=Object(I.a)(this.generateDefenseDice());try{for(a.s();!(e=a.n()).done;){switch(e.value.roll(this.rng)){case x.block:t++;break;case x.surge:this.stats.surges&&t++;break;case x.blank:}}}catch(n){a.e(n)}finally{a.f()}return this.pierce&&"immune"!==this.stats.pierce&&(t=Math.max(0,t-this.pierce)),Math.max(0,this.hits-t)}}]),e}(),P=function(){function e(t){Object(o.a)(this,e),this.config=t,this.rng=void 0,this.rng=new w.a(t.rngSeed)}return Object(s.a)(e,[{key:"generateAttackDice",value:function(){for(var e=[],t=this.config.pool,a=0;a<t.red;a++)e.push(J.red());for(var n=0;n<t.black;n++)e.push(J.black());for(var r=0;r<t.white;r++)e.push(J.white());return e}},{key:"staticSortDice",value:function(e,t){}},{key:"simulate",value:function(){for(var e=this,t=Array(this.config.iterations),a=0;a<t.length;a++){var n=this.generateAttackDice().map((function(t){return{dice:t,roll:t.roll(e.rng)}})).sort((function(e,t){return e.dice.order-t.dice.order}));t[a]=new z(this.rng,n,this.config.modifiers,this.config.tokens)}return t}}]),e}(),W=[{name:"Expected Hits",dice:M.none()},{name:"B1 Battle Droid",dice:M.white()},{name:"B2 Battle Droid",dice:M.white(),armor:1},{name:"Rebel Trooper",dice:M.white(),surges:!0},{name:"Stormtrooper",dice:M.red()},{name:"Deathtrooper",dice:M.red(),surges:!0},{name:"Boba Fett",dice:M.red(),surges:!0,pierce:"impervious"},{name:"Darth Vader",dice:M.red(),pierce:"immune"},{name:"Emperor Palpatine",dice:M.red(),pierce:"immune",surges:!0},{name:"Rebel AT-RT",dice:M.white(),armor:!0},{name:"X-34 Landpseeder",dice:M.white(),surges:!0,armor:2},{name:"AT-ST",dice:M.white(),surges:!0,armor:!0},{name:"Dewback Rider",dice:M.red(),armor:1},{name:"Occupier Tank",dice:M.red(),armor:!0}];function G(e,t){return Number.parseFloat(e)-Number.parseFloat(t)}var V=function(e){var t,a=[],n=Object(I.a)(W);try{for(n.s();!(t=n.n()).done;){for(var i=t.value,c=[[],[],[]],l=0;l<c.length;l++){var o,s=Object(I.a)(e.data);try{for(s.s();!(o=s.n()).done;){var u=o.value;c[l].push(u.hits(l,i).wounds())}}catch(h){s.e(h)}finally{s.f()}}var m=c.map((function(e){return H.mean(e).toFixed(2)}));a.push({key:i.name,cover0:m[0],cover1:m[1],cover2:m[2]})}}catch(h){n.e(h)}finally{n.f()}return r.a.createElement(A.a,{bordered:!0,columns:[{title:"Defending",key:"key",dataIndex:"key",sorter:function(e,t){return function(e,t){return e>t?1:e<t?-1:0}(e.key,t.key)}},{title:"No Cover",key:"cover0",dataIndex:"cover0",sorter:function(e,t){return G(e.cover0,t.cover0)}},{title:"Cover 1",key:"cover1",dataIndex:"cover1",sorter:function(e,t){return G(e.cover1,t.cover1)}},{title:"Cover 2",key:"cover2",dataIndex:"cover2",sorter:function(e,t){return G(e.cover2,t.cover2)}}],dataSource:a,pagination:!1,size:"small"})},X=function(e){var t,a=new P(e.simulate).simulate(),n={},i=new Set,c=Object(I.a)(a);try{for(c.s();!(t=c.n()).done;){var l=t.value.rawTotalHits;n[l]=(n[l]||0)+1,i.add(l)}}catch(o){c.e(o)}finally{c.f()}return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{animate:{duration:1e3},domainPadding:{x:15},height:200},r.a.createElement(R.a,{data:Object.entries(n).map((function(e){return{x:e[0],y:e[1]}})),labels:function(e){var t=e.datum;return"".concat((t.y/a.length*100).toFixed(0),"%")},style:{data:{fill:"tomato"}}}),r.a.createElement(T.a,{style:{axisLabel:{padding:30}}})),r.a.createElement(V,{data:a,mods:{impact:e.simulate.modifiers.impact}}))},q=a(125),K=a(509),Q=q.a.Option,U=function(e){return r.a.createElement(f.a,{labelCol:{xs:{span:24},sm:{span:12}}},r.a.createElement(f.a.Item,{label:"Surge"},r.a.createElement(q.a,{value:e.modifiers.surge,onChange:function(t){e.onChanged(Object(l.a)({},e.modifiers,{surge:t}))}},r.a.createElement(Q,{value:j.blank},"None"),r.a.createElement(Q,{value:j.hit},"Hit"),r.a.createElement(Q,{value:j.crit},"Crit"))),r.a.createElement(K.a,null),r.a.createElement(f.a.Item,{label:"Critical"},r.a.createElement(O.a,{value:e.modifiers.critical,min:0,onChange:function(t){e.onChanged(Object(l.a)({},e.modifiers,{critical:0===t?0:t||e.modifiers.critical}))}})),r.a.createElement(f.a.Item,{label:"Impact"},r.a.createElement(O.a,{value:e.modifiers.impact,min:0,onChange:function(t){e.onChanged(Object(l.a)({},e.modifiers,{impact:0===t?0:t||e.modifiers.impact}))}})),r.a.createElement(f.a.Item,{label:"Pierce"},r.a.createElement(O.a,{value:e.modifiers.pierce,min:0,onChange:function(t){e.onChanged(Object(l.a)({},e.modifiers,{pierce:0===t?0:t||e.modifiers.pierce}))}})))},Y=a(515);function Z(e){switch(e){case 1:return 10;case 2:return 100;case 3:return 1e3;case 4:return 1e4;case 5:return 1e5;default:return ie.defaultState.iterations}}var $=function(e){return r.a.createElement(Y.a,{min:1,max:5,marks:{1:"10",3:"1000",5:"100000"},value:(t=e.value,t.toString().length-1),tipFormatter:Z,onChange:function(t){return e.onChanged(Z(t))}});var t},_=a(517),ee=a(530),te=function(e){return r.a.createElement(g.a,null,r.a.createElement(b.a,{span:18},r.a.createElement(_.a,{value:e.value,maxLength:10,onChange:function(t){return e.onChanged(t.target.value)}})),r.a.createElement(b.a,{span:2,offset:2},r.a.createElement(v.a,{icon:r.a.createElement(ee.a,null),title:"Randomize",onClick:function(){return e.onChanged((new w.a).nextString(10))}})))},ae=function(e){return r.a.createElement(f.a,{labelCol:{xs:{span:24},sm:{span:8}}},r.a.createElement(f.a.Item,{label:"Surge"},r.a.createElement(O.a,{value:e.tokens.surge,min:0,onChange:function(t){e.onChanged(Object(l.a)({},e.tokens,{surge:0===t?0:t||e.tokens.surge}))}})))},ne=h.a.Sider,re=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(o.a)(this,a),n=t.call(this,e);var r=JSON.parse(JSON.stringify(a.defaultState));return n.state=Object(l.a)({},r,{},function(e){var t=window.location.hash;if(t){var a=t.indexOf("#");if(-1!==a&&(t=t.substring(a+1)),t&&t.length&&"default"!==t)return JSON.parse(atob(t))}}(window.location.hash)),n}return Object(s.a)(a,[{key:"encodeStateIfChanged",value:function(){var e=C(this.state);e===a.defaultEncodedState?window.location.hash="default":window.location.hash=e}},{key:"render",value:function(){var e=this;return this.encodeStateIfChanged(),r.a.createElement(h.a,{style:{minHeight:"100vh",height:"100%"}},r.a.createElement(ne,{breakpoint:"lg",collapsedWidth:"0",width:"250px",style:{minHeight:"100vh",height:"100%"}},r.a.createElement("div",{className:"logo"},r.a.createElement("strong",null,"RollCrits")," #",a.shortHash),r.a.createElement(d.a,{title:r.a.createElement("span",null,r.a.createElement(k.a,null),r.a.createElement("span",null," Settings"))},r.a.createElement(f.a,{layout:"vertical"},r.a.createElement(f.a.Item,{label:"Iterations"},r.a.createElement($,{value:this.state.iterations,onChanged:function(t){return e.setState({iterations:t})}})),r.a.createElement(f.a.Item,{label:"RNG Seed"},r.a.createElement(te,{value:this.state.rngSeed,onChanged:function(t){return e.setState({rngSeed:t})}})),r.a.createElement(g.a,null,r.a.createElement(b.a,{span:24},r.a.createElement(v.a,{block:!0,disabled:"#default"===window.location.hash,type:"danger",onClick:function(){e.setState(a.defaultState)}},"Reset"))))),r.a.createElement(d.a,{title:r.a.createElement("span",null,r.a.createElement(p.a,null),r.a.createElement("span",null," Dice"))},r.a.createElement(D,{dice:this.state.pool,onChanged:function(t){e.setState({pool:t})}})),r.a.createElement(d.a,{title:r.a.createElement("span",null,r.a.createElement(E.a,null),r.a.createElement("span",null," Modifiers"))},r.a.createElement(U,{modifiers:this.state.modifiers,onChanged:function(t){e.setState({modifiers:t})}})),r.a.createElement(d.a,{title:r.a.createElement("span",null,r.a.createElement(y.a,null),r.a.createElement("span",null," Tokens"))},r.a.createElement(ae,{tokens:this.state.tokens,onChanged:function(t){e.setState({tokens:t})}}))),r.a.createElement(h.a,null,r.a.createElement(h.a.Content,{style:{margin:"24px 16px 0"}},r.a.createElement("div",{className:"content-module"},r.a.createElement(X,{simulate:this.state})))))}}]),a}(r.a.Component);re.defaultState=Object.freeze({pool:{red:1,black:1,white:1},modifiers:{critical:0,impact:0,marksman:!1,pierce:0,precise:0,surge:j.blank},tokens:{surge:0,aim:0,dodge:0},iterations:1e4,rngSeed:"".concat((new w.a).nextString(10))}),re.defaultEncodedState=C(re.defaultState),re.shortHash="0175263";var ie=re;c.a.render(r.a.createElement(ie,null),document.getElementById("root"))}},[[288,1,2]]]);
//# sourceMappingURL=main.388b816a.chunk.js.map