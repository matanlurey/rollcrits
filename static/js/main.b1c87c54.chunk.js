(this.webpackJsonprollcrits=this.webpackJsonprollcrits||[]).push([[0],{306:function(e,t,a){e.exports=a(529)},311:function(e,t,a){},312:function(e,t,a){},416:function(e,t,a){},529:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(12),l=a.n(i),c=(a(311),a(44)),s=a(38),o=a(39),u=a(85),m=a(83),h=a(539),d=a(120),f=a(53),g=a(542),p=a(541),b=a(32),v=a(559),E=a(560),k=a(561),w=a(562),y=(a(312),a(77));(new y.a).nextString(10);function C(e){return btoa(JSON.stringify(e))}var O=a(550);function S(e){return r.a.createElement(p.a.Item,{label:e.label},r.a.createElement(O.a,{value:e.count,min:0,onChange:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e.onChange(Number.isInteger(t)?t:e.count)}}))}var D,j,x=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=this,t=this.props.dice;return r.a.createElement(p.a,{labelCol:{xs:{span:24},sm:{span:12}}},r.a.createElement(S,{label:"Red",count:t.red,onChange:function(t){return e.updateDice({red:t})}}),r.a.createElement(S,{label:"Black",count:t.black,onChange:function(t){return e.updateDice({black:t})}}),r.a.createElement(S,{label:"White",count:t.white,onChange:function(t){return e.updateDice({white:t})}}))}},{key:"updateDice",value:function(e){this.props.onChanged(Object(c.a)({},this.props.dice,{},e))}}]),a}(r.a.Component),I=a(92),A=a(549),M=a(547),T=a(552),N=a(540),R=a(553),F=a(302),H=(a(416),a(266));!function(e){e.blank="blank",e.surge="surge",e.hit="hit",e.crit="crit"}(D||(D={})),function(e){e.blank="blank",e.surge="surge",e.block="block"}(j||(j={}));var B={white:[D.crit,D.surge,D.hit,D.blank,D.blank,D.blank,D.blank,D.blank],black:[D.crit,D.surge,D.hit,D.hit,D.hit,D.blank,D.blank,D.blank],red:[D.crit,D.surge,D.hit,D.hit,D.hit,D.hit,D.hit,D.blank]},J={white:[j.block,j.surge,j.blank,j.blank,j.blank,j.blank],red:[j.block,j.block,j.block,j.surge,j.blank,j.blank]},P=function(){function e(t,a){Object(s.a)(this,e),this.sides=t,this.order=a}return Object(o.a)(e,[{key:"roll",value:function(e){return e.nextArrayItem(this.sides)}}]),e}();P.red=new P(B.red,3),P.black=new P(B.black,3),P.white=new P(B.white,3);var z=function(){function e(t){Object(s.a)(this,e),this.sides=t}return Object(o.a)(e,[{key:"roll",value:function(e){return e.nextArrayItem(this.sides)}}]),e}();z.red=new z(J.red),z.white=new z(J.white),z.none=new z([j.blank]);var L=function(){function e(t,a,n,r){Object(s.a)(this,e),this.rng=t,this.result=a,this.modifiers=n,this.tokens=r}return Object(o.a)(e,[{key:"applyAimToken",value:function(e,t,a,n,r,i){for(var l=this,c=function(e){var t=e.dice.roll(l.rng);t===D.surge&&(n?(t=D.crit,n--):"blank"!==l.modifiers.surge&&r?(t=D.hit,r--):t=l.modifiers.surge),e.roll=t,a--},s=0;s<e.length&&a;s++)switch(e[s].roll){case D.blank:c(e[s])}if(i)for(var o=0;o<e.length&&a;o++)switch(e[o].roll){case D.hit:this.shouldRerollHit(e[o].dice,n,t,i)&&c(e[o])}}},{key:"shouldRerollHit",value:function(e,t,a,n){var r=n.cover;return!0===n.defender.armor&&(r+=Math.max(0,a.hits-this.modifiers.impact)),r>=a.hits}},{key:"aggregateDice",value:function(e){for(var t=this.result.map((function(e){return{dice:e.dice,roll:e.roll}})),a=this.modifiers.critical,n=this.tokens.surge,r=0,i=0,l=function(){r=0,i=0;var e,a=Object(I.a)(t);try{for(a.s();!(e=a.n()).done;){switch(e.value.roll){case D.crit:i++;break;case D.hit:r++}}}catch(n){a.e(n)}finally{a.f()}},c=t.length-1;c>=0;c--){var s=t[c],o=s.roll;o===D.surge&&(a?(o=D.crit,a--):"blank"!==this.modifiers.surge&&n?(o=D.hit,n--):o=this.modifiers.surge),s.roll=o}for(var u=this.tokens.aim;u;)l(),this.applyAimToken(t,{hits:r,crits:i},2+this.modifiers.precise,a,n,e),u--;return l(),{hits:r,crits:i}}},{key:"hits",value:function(e,t){var a=this.aggregateDice({cover:e,defender:t}),n=a.hits,r=a.crits;if(n=Math.max(0,n-e),t.armor){var i=Math.min(n,this.modifiers.impact);n-=i,r+=i,n=!0===t.armor?0:Math.max(0,n-t.armor)}return new W(this.rng,n+r,t,this.modifiers.pierce)}},{key:"rawTotalHits",get:function(){var e=this.aggregateDice();return e.hits+e.crits}}]),e}(),W=function(){function e(t,a,n,r){Object(s.a)(this,e),this.rng=t,this.hits=a,this.stats=n,this.pierce=r}return Object(o.a)(e,[{key:"generateDefenseDice",value:function(){var e=this.hits;return"impervious"===this.stats.pierce&&(e+=this.pierce),Array(e).fill(this.stats.dice)}},{key:"wounds",value:function(){var e,t=0,a=Object(I.a)(this.generateDefenseDice());try{for(a.s();!(e=a.n()).done;){switch(e.value.roll(this.rng)){case j.block:t++;break;case j.surge:this.stats.surges&&t++;break;case j.blank:}}}catch(n){a.e(n)}finally{a.f()}return this.pierce&&"immune"!==this.stats.pierce&&(t=Math.max(0,t-this.pierce)),Math.max(0,this.hits-t)}}]),e}(),q=function(){function e(t){Object(s.a)(this,e),this.config=t,this.rng=void 0,this.rng=new y.a(t.rngSeed)}return Object(o.a)(e,[{key:"generateAttackDice",value:function(){for(var e=[],t=this.config.pool,a=0;a<t.red;a++)e.push(P.red);for(var n=0;n<t.black;n++)e.push(P.black);for(var r=0;r<t.white;r++)e.push(P.white);return e}},{key:"staticSortDice",value:function(e,t){}},{key:"simulate",value:function(){for(var e=this,t=Array(this.config.iterations),a=0;a<t.length;a++){var n=this.generateAttackDice().map((function(t){return{dice:t,roll:t.roll(e.rng)}})).sort((function(e,t){return e.dice.order-t.dice.order}));t[a]=new L(this.rng,n,this.config.modifiers,this.config.tokens)}return t}}]),e}(),G=a(279),U=a.n(G),V=a(136),X=a.n(V),K=a(563),Q=[{name:"B1 Battle Droid",dice:z.white},{name:"B2 Battle Droid",dice:z.white,armor:1},{name:"Rebel Trooper",dice:z.white,surges:!0},{name:"Stormtrooper",dice:z.red},{name:"Deathtrooper",dice:z.red,surges:!0},{name:"Boba Fett",dice:z.red,surges:!0,pierce:"impervious"},{name:"Darth Vader",dice:z.red,pierce:"immune"},{name:"Emperor Palpatine",dice:z.red,pierce:"immune",surges:!0},{name:"Rebel AT-RT",dice:z.white,armor:!0},{name:"X-34 Landpseeder",dice:z.white,surges:!0,armor:2},{name:"AT-ST",dice:z.white,surges:!0,armor:!0},{name:"Dewback Rider",dice:z.red,armor:1},{name:"Occupier Tank",dice:z.red,armor:!0}];function Y(e,t){return Number.parseFloat(e)-Number.parseFloat(t)}var Z=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e,t=this,a=[],n=Object(I.a)(Q);try{for(n.s();!(e=n.n()).done;){for(var i=e.value,l=[[],[],[]],c=0;c<l.length;c++){var s,o=Object(I.a)(this.props.data);try{for(o.s();!(s=o.n()).done;){var u=s.value;l[c].push(u.hits(c,i).wounds())}}catch(h){o.e(h)}finally{o.f()}}var m=l.map((function(e){return H.mean(e).toFixed(2)}));a.push({key:i.name,unit:i,cover0:m[0],cover1:m[1],cover2:m[2]})}}catch(h){n.e(h)}finally{n.f()}return r.a.createElement(N.a,{bordered:!0,dataSource:a,pagination:!1,size:"small"},r.a.createElement(X.a,{title:"Defending Unit",dataIndex:"unit",key:"unit",sorter:function(e,t){return function(e,t){return e>t?1:e<t?-1:0}(e.name,t.name)},render:function(e){return r.a.createElement(d.a,null,r.a.createElement(f.a,{span:24},e.name),r.a.createElement(F.a,{query:"(min-width: 499px)",render:function(){return r.a.createElement(f.a,{span:24,hidden:!t.props.showDefenderDetails},function(e){var t=[r.a.createElement(R.a,{color:e.dice===z.red?"red":"default",key:"dice",style:{transform:"scale(0.5) rotate(45deg)"}},"\xa0")];e.surges&&t.push(r.a.createElement(R.a,{color:e.dice===z.red?"red":"default",key:"surges"},"Surge: ",r.a.createElement(K.a,null)," "));e.pierce&&("impervious"===e.pierce?t.push(r.a.createElement(R.a,{color:"volcano",key:"pierce"},r.a.createElement("span",null,"Impervious"))):t.push(r.a.createElement(R.a,{color:"volcano",key:"pierce"},"Immune: Pierce")));e.armor&&(!0===e.armor?t.push(r.a.createElement(R.a,{color:"magenta",key:"armor"},"Armor: ",r.a.createElement("strong",null,"\u221e"))):t.push(r.a.createElement(R.a,{color:"magenta",key:"armor"},"Armor: ",e.armor)));return r.a.createElement(r.a.Fragment,null,t)}(e))}}))}}),r.a.createElement(U.a,{title:"Cover"},r.a.createElement(X.a,{title:"0",dataIndex:"cover0",key:"cover0",sorter:function(e,t){return Y(e,t)}}),r.a.createElement(X.a,{title:"1",dataIndex:"cover1",key:"cover1",sorter:function(e,t){return Y(e,t)}}),r.a.createElement(X.a,{title:"2",dataIndex:"cover2",key:"cover2",sorter:function(e,t){return Y(e,t)}})))}}]),a}(r.a.Component);var $=function(e){var t,a=new q(e.simulate).simulate(),n={},i=new Set,l=Object(I.a)(a);try{for(l.s();!(t=l.n()).done;){var c=t.value.rawTotalHits;n[c]=(n[c]||0)+1,i.add(c)}}catch(s){l.e(s)}finally{l.f()}return r.a.createElement(r.a.Fragment,null,r.a.createElement(A.a,{animate:{duration:1e3},domainPadding:{x:25},height:200},r.a.createElement(M.a,{data:Object.entries(n).map((function(e){return{x:e[0],y:e[1]}})),labels:function(e){var t=e.datum;return"".concat((t.y/a.length*100).toFixed(0),"%")},style:{data:{fill:"tomato"}}}),r.a.createElement(T.a,{style:{axisLabel:{padding:30}}})),r.a.createElement(Z,{data:a,mods:{impact:e.simulate.modifiers.impact},showDefenderDetails:e.simulate.settings.showDefenderDetails}))},_=a(134),ee=a(537),te=_.a.Option,ae=function(e){return r.a.createElement(p.a,{labelCol:{xs:{span:24},sm:{span:12}}},r.a.createElement(p.a.Item,{label:"Surge"},r.a.createElement(_.a,{value:e.modifiers.surge,onChange:function(t){e.onChanged(Object(c.a)({},e.modifiers,{surge:t}))}},r.a.createElement(te,{value:D.blank},"None"),r.a.createElement(te,{value:D.hit},"Hit"),r.a.createElement(te,{value:D.crit},"Crit"))),r.a.createElement(ee.a,null),r.a.createElement(p.a.Item,{label:"Critical"},r.a.createElement(O.a,{value:e.modifiers.critical,min:0,onChange:function(t){e.onChanged(Object(c.a)({},e.modifiers,{critical:0===t?0:t||e.modifiers.critical}))}})),r.a.createElement(p.a.Item,{label:"Impact"},r.a.createElement(O.a,{value:e.modifiers.impact,min:0,onChange:function(t){e.onChanged(Object(c.a)({},e.modifiers,{impact:0===t?0:t||e.modifiers.impact}))}})),r.a.createElement(p.a.Item,{label:"Pierce"},r.a.createElement(O.a,{value:e.modifiers.pierce,min:0,onChange:function(t){e.onChanged(Object(c.a)({},e.modifiers,{pierce:0===t?0:t||e.modifiers.pierce}))}})),r.a.createElement(p.a.Item,{label:"Precise"},r.a.createElement(O.a,{value:e.modifiers.precise,min:0,onChange:function(t){e.onChanged(Object(c.a)({},e.modifiers,{precise:0===t?0:t||e.modifiers.precise}))}})))},ne=a(545);function re(e){switch(e){case 1:return 10;case 2:return 100;case 3:return 1e3;case 4:return 1e4;case 5:return 1e5;default:return pe.defaultState.iterations}}var ie=function(e){return r.a.createElement(ne.a,{min:1,max:5,marks:{1:"10",3:"1000",5:"100000"},value:(t=e.value,t.toString().length-1),tipFormatter:re,onChange:function(t){return e.onChanged(re(t))}});var t},le=a(546),ce=a(558),se=function(e){return r.a.createElement(d.a,null,r.a.createElement(f.a,{span:18},r.a.createElement(le.a,{value:e.value,maxLength:10,onChange:function(t){return e.onChanged(t.target.value)}})),r.a.createElement(f.a,{span:2,offset:2},r.a.createElement(b.a,{icon:r.a.createElement(ce.a,null),title:"Randomize",onClick:function(){return e.onChanged((new y.a).nextString(10))}})))},oe=function(e){return r.a.createElement(p.a,{labelCol:{xs:{span:24},sm:{span:12}}},r.a.createElement(p.a.Item,{label:"Aim"},r.a.createElement(O.a,{value:e.tokens.aim,min:0,onChange:function(t){e.onChanged(Object(c.a)({},e.tokens,{aim:0===t?0:t||e.tokens.aim}))}})),r.a.createElement(p.a.Item,{label:"Surge"},r.a.createElement(O.a,{value:e.tokens.surge,min:0,onChange:function(t){e.onChanged(Object(c.a)({},e.tokens,{surge:0===t?0:t||e.tokens.surge}))}})))},ue=a(555),me=a(544),he=a(538),de=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={showDefenderDetails:e.settings.showDefenderDetails,showModel:!1},n}return Object(o.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,{icon:r.a.createElement(ue.a,null),ghost:!0,size:"small",title:"Settings",onClick:function(){return e.setState({showModel:!0})}}),r.a.createElement(me.a,{visible:this.state.showModel,onOk:function(){e.setState({showModel:!1}),e.props.onChange({showDefenderDetails:e.state.showDefenderDetails})},onCancel:function(){return e.setState({showModel:!1,showDefenderDetails:e.props.settings.showDefenderDetails})},okText:"Save"},r.a.createElement(p.a,null,r.a.createElement(p.a.Item,{label:"Show defender details"},r.a.createElement(he.a,{checked:this.state.showDefenderDetails,onChange:function(t){e.setState({showDefenderDetails:t})}})))))}}]),a}(r.a.Component),fe=h.a.Sider,ge=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(s.a)(this,a),n=t.call(this,e);var r=JSON.parse(JSON.stringify(a.defaultState));return n.state=Object(c.a)({},r,{},function(e){var t=window.location.hash;if(t){var a=t.indexOf("#");if(-1!==a&&(t=t.substring(a+1)),t&&t.length&&"default"!==t)return JSON.parse(atob(t))}}(window.location.hash)),n}return Object(o.a)(a,[{key:"encodeStateIfChanged",value:function(){var e=C(this.state);e===a.defaultEncodedState?window.location.hash="default":window.location.hash=e}},{key:"render",value:function(){var e=this;return this.encodeStateIfChanged(),r.a.createElement(h.a,{style:{minHeight:"100vh",height:"100%"}},r.a.createElement(fe,{breakpoint:"lg",collapsedWidth:"0",width:"250px",style:{minHeight:"100vh",height:"100%"}},r.a.createElement("div",{className:"logo"},r.a.createElement(d.a,null,r.a.createElement(f.a,{span:10},r.a.createElement("strong",null,"RollCrits")),r.a.createElement(f.a,{span:10},"#",a.shortHash),r.a.createElement(f.a,{span:2},r.a.createElement(de,{settings:this.state.settings,onChange:function(t){e.setState({settings:t})}})))),r.a.createElement(g.a,{title:r.a.createElement("span",null,r.a.createElement(v.a,null),r.a.createElement("span",null," Simulation"))},r.a.createElement(p.a,{layout:"vertical"},r.a.createElement(p.a.Item,{label:"Iterations"},r.a.createElement(ie,{value:this.state.iterations,onChanged:function(t){return e.setState({iterations:t})}})),r.a.createElement(p.a.Item,{label:"RNG Seed"},r.a.createElement(se,{value:this.state.rngSeed,onChanged:function(t){return e.setState({rngSeed:t})}})),r.a.createElement(d.a,null,r.a.createElement(f.a,{span:24},r.a.createElement(b.a,{block:!0,disabled:"#default"===window.location.hash,type:"danger",onClick:function(){e.setState(a.defaultState)}},"Reset"))))),r.a.createElement(g.a,{title:r.a.createElement("span",null,r.a.createElement(E.a,null),r.a.createElement("span",null," Dice"))},r.a.createElement(x,{dice:this.state.pool,onChanged:function(t){e.setState({pool:t})}})),r.a.createElement(g.a,{title:r.a.createElement("span",null,r.a.createElement(k.a,null),r.a.createElement("span",null," Modifiers"))},r.a.createElement(ae,{modifiers:this.state.modifiers,onChanged:function(t){e.setState({modifiers:t})}})),r.a.createElement(g.a,{title:r.a.createElement("span",null,r.a.createElement(w.a,null),r.a.createElement("span",null," Tokens"))},r.a.createElement(oe,{tokens:this.state.tokens,onChanged:function(t){e.setState({tokens:t})}}))),r.a.createElement(h.a,null,r.a.createElement(h.a.Content,{style:{margin:"24px 16px 0"}},r.a.createElement("div",{className:"content-module"},r.a.createElement($,{simulate:this.state})))))}}]),a}(r.a.Component);ge.defaultState=Object.freeze({pool:{red:1,black:1,white:1},modifiers:{critical:0,impact:0,marksman:!1,pierce:0,precise:0,surge:D.blank},tokens:{surge:0,aim:0,dodge:0},iterations:1e4,rngSeed:"".concat((new y.a).nextString(10)),settings:{showDefenderDetails:!1}}),ge.defaultEncodedState=C(ge.defaultState),ge.shortHash="5e8fb81";var pe=ge;l.a.render(r.a.createElement(pe,null),document.getElementById("root"))}},[[306,1,2]]]);
//# sourceMappingURL=main.b1c87c54.chunk.js.map